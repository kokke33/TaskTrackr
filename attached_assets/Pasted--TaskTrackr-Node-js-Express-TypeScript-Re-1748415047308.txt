# TaskTrackr - マネージャ定例議事録機能実装プロンプト

## プロジェクト概要
- **技術スタック**: Node.js + Express + TypeScript + React + Drizzle ORM + PostgreSQL
- **プロジェクトパス**: `/home/kokke/TaskTrackr`
- **要求**: プロジェクト詳細画面にマネージャ定例議事録機能を追加。月ごとにデータ参照可能にする

## 実装タスク一覧

### 1. データベーススキーマ追加
**ファイル**: `shared/schema.ts`
**タスク**: 
- `managerMeetings`テーブル定義を追加
- プロジェクトとの関係性定義
- バリデーションスキーマと型定義

**必要フィールド**:
- id (serial, primary key)
- projectId (integer, foreign key to projects.id)  
- meetingDate (date, 開催日)
- yearMonth (text, 'YYYY-MM'形式)
- title (text, 議事録タイトル)
- content (text, 議事録内容 - メインの議事録エリア)
- createdAt, updatedAt (timestamp)

### 2. データベースマイグレーション
**ファイル**: `server/migrations/add_manager_meetings.sql`
**タスク**: テーブル作成、インデックス、トリガー設定

### 3. ストレージ層実装
**ファイル**: `server/storage.ts`
**タスク**: 
- マネージャ定例議事録のCRUD操作メソッド追加
- 月別データ取得メソッド
- プロジェクト別データ取得メソッド

**必要メソッド**:
- `createManagerMeeting(data)` - 新規作成
- `getManagerMeetingsByProject(projectId, yearMonth?)` - プロジェクト別取得
- `getManagerMeeting(id)` - 個別取得
- `updateManagerMeeting(id, data)` - 更新
- `deleteManagerMeeting(id)` - 削除
- `getAvailableMonths(projectId)` - 利用可能月リスト取得

### 4. APIエンドポイント実装
**ファイル**: `server/routes.ts`
**タスク**: RESTful APIエンドポイント追加

**必要エンドポイント**:
- `GET /api/projects/:id/manager-meetings` - 一覧取得（月指定可能）
- `GET /api/projects/:id/manager-meetings/months` - 利用可能月取得
- `POST /api/projects/:id/manager-meetings` - 新規作成
- `GET /api/manager-meetings/:id` - 個別取得
- `PUT /api/manager-meetings/:id` - 更新
- `DELETE /api/manager-meetings/:id` - 削除

### 5. フロントエンド - プロジェクト詳細画面修正
**ファイル**: `client/src/pages/project-detail.tsx`
**タスク**: 
- 新しいタブ「マネ定議事録」を追加
- 月別表示機能の実装
- 議事録一覧表示
- CRUD操作のUI実装

**UI要件**:
- 年月選択ドロップダウン（例：2025年5月）
- 選択月の議事録一覧カード表示
- 「新規作成」ボタン
- 各議事録に「編集」「削除」ボタン
- 議事録がない月は「未実施」表示

### 6. フロントエンド - 議事録フォームコンポーネント作成
**ファイル**: `client/src/components/manager-meeting-form.tsx`
**タスク**: 議事録の入力・編集フォーム作成

**フォーム項目**:
- 開催日（日付選択）
- タイトル（テキスト）
- 議事録内容（テキストエリア、メイン項目）

### 7. フロントエンド - 議事録一覧コンポーネント作成
**ファイル**: `client/src/components/manager-meeting-list.tsx`
**タスク**: 月別議事録一覧表示コンポーネント

## 技術仕様

### 権限制御
- 閲覧：プロジェクトメンバー（認証済みユーザー）
- 作成・編集・削除：管理者のみ（`isAdmin`フラグ使用）

### データ形式
- 年月形式：'YYYY-MM'（例：'2025-05'）
- 日付形式：'YYYY-MM-DD'

### UI/UX方針
- 既存のshadcn/uiコンポーネントを活用
- レスポンシブデザイン対応
- 既存デザインとの統一性保持

## 実装順序
1. スキーマ定義 → マイグレーション
2. ストレージ層 → API層
3. フロントエンドコンポーネント → プロジェクト詳細画面統合

## テストデータ例
```json
{
  "meetingDate": "2025-05-15",
  "yearMonth": "2025-05",
  "title": "5月度マネージャ定例会議",
  "content": "【進捗確認】\n・MSAD_NEC_共同損サ: 順調に進行中、テスト工程に入る予定\n・NOSL_日新火災_契約管理: 設計書レビュー完了、開発着手\n・タタ_AIG_保守: 月次保守作業完了、特に問題なし\n\n【課題・懸念事項】\n・MSAD案件でNECとの調整に若干遅れ\n・日新火災案件の要件追加検討中\n\n【アクションアイテム】\n・MSAD案件のスケジュール調整（山村）\n・日新火災要件確認（担当者）\n\n【次回予定】\n・6月15日開催予定\n・四半期レビューも合わせて実施"
}
```

この仕様書に基づいて、段階的に実装を進めてください。